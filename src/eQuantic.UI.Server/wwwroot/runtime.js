class Z{id;className;style;styleClass;dataAttributes;ariaAttributes;children=[];buildAttributes(){let j={};if(this.id)j.id=this.id;let q=[];if(this.className)q.push(this.className);if(this.styleClass)q.push(this.styleClass.generatedClassName);if(q.length>0)j.class=q.join(" ");if(this.style)j.style=Object.entries(this.style).map(([J,K])=>`${J}: ${K}`).join("; ");if(this.dataAttributes)for(let[J,K]of Object.entries(this.dataAttributes))j[`data-${J}`]=K;if(this.ariaAttributes)for(let[J,K]of Object.entries(this.ariaAttributes))j[`aria-${J}`]=K;return j}}class B{eventListeners=[];reconcile(j,q,J,K=0){let O=j.childNodes[K];if(!q&&J){let X=this.createDomElement(J);j.appendChild(X);return}if(!J){if(O)this.cleanupEventListeners(O),j.removeChild(O);return}if(!q||!J)return;if(this.isDifferentNodeType(q,J)){let X=this.createDomElement(J);if(O)this.cleanupEventListeners(O),j.replaceChild(X,O);else j.appendChild(X);return}if(O){if(J.tag==="#text"){if(q.textContent!==J.textContent)O.textContent=J.textContent||"";return}if(O instanceof HTMLElement)this.updateAttributes(O,q.attributes,J.attributes),this.updateEventListeners(O,q.events,J.events),this.reconcileChildren(O,q.children,J.children)}}isDifferentNodeType(j,q){return j.tag!==q.tag}createDomElement(j){if(j.tag==="#text")return document.createTextNode(j.textContent||"");let q=document.createElement(j.tag);for(let[J,K]of Object.entries(j.attributes))if(K!==void 0&&K!==null)q.setAttribute(J,String(K));this.attachEventListeners(q,j.events);for(let J of j.children)q.appendChild(this.createDomElement(J));return q}updateAttributes(j,q,J){for(let K of Object.keys(q))if(!(K in J))j.removeAttribute(K);for(let[K,O]of Object.entries(J)){let X=q[K];if(O!==X)if(O!==void 0&&O!==null)j.setAttribute(K,String(O));else j.removeAttribute(K)}}attachEventListeners(j,q){for(let[J,K]of Object.entries(q)){if(!K)continue;let O=(X)=>{if(J==="change"||J==="input"){let _=X.target;K(_.value)}else if(J==="click")K();else K(X)};j.addEventListener(J,O),this.eventListeners.push({element:j,eventName:J,handler:O})}}updateEventListeners(j,q,J){for(let K of Object.keys(q))if(!(K in J)){let O=this.eventListeners.find((X)=>X.element===j&&X.eventName===K);if(O)j.removeEventListener(K,O.handler),this.eventListeners=this.eventListeners.filter((X)=>X!==O)}for(let[K,O]of Object.entries(J)){let X=q[K];if(O!==X){let _=this.eventListeners.find((Y)=>Y.element===j&&Y.eventName===K);if(_)j.removeEventListener(K,_.handler),this.eventListeners=this.eventListeners.filter((Y)=>Y!==_);if(O){let Y=(F)=>{if(K==="change"||K==="input"){let u=F.target;O(u.value)}else if(K==="click")O();else O(F)};j.addEventListener(K,Y),this.eventListeners.push({element:j,eventName:K,handler:Y})}}}}reconcileChildren(j,q,J){let K=Math.max(q.length,J.length);for(let O=0;O<K;O++){let X=q[O]||null,_=J[O]||null;if(!_&&X){let Y=j.childNodes[O];if(Y)this.cleanupEventListeners(Y),j.removeChild(Y)}else if(_)this.reconcile(j,X,_,O)}}cleanupEventListeners(j){if(j instanceof HTMLElement){this.eventListeners=this.eventListeners.filter((q)=>{if(q.element===j)return j.removeEventListener(q.eventName,q.handler),!1;return!0});for(let q=0;q<j.childNodes.length;q++)this.cleanupEventListeners(j.childNodes[q])}}dispose(){for(let j of this.eventListeners)j.element.removeEventListener(j.eventName,j.handler);this.eventListeners=[]}getEventListenerCount(){return this.eventListeners.length}}var $=null;function D(){if(!$)$=new B;return $}function w(){if($)$.dispose();$=null}class G{previousVirtualDom=null;container=null;mount(j,q){this.container=q,this.previousVirtualDom=j;let K=D().createDomElement(j);q.appendChild(K)}update(j){if(!this.container)throw Error("Cannot update before mounting");let q=D();if(this.previousVirtualDom)q.reconcile(this.container,this.previousVirtualDom,j,0);else{let J=q.createDomElement(j);this.container.appendChild(J)}this.previousVirtualDom=j}unmount(){if(this.container){let j=D();while(this.container.firstChild)j.reconcile(this.container,this.previousVirtualDom,null,0);this.previousVirtualDom=null,this.container=null}}getContainer(){return this.container}}var U;((K)=>{K.Transient="transient";K.Singleton="singleton";K.Scoped="scoped"})(U||={});class Q{services=new Map;scopedInstances=new Map;parent=null;constructor(j){this.parent=j||null}registerSingleton(j,q){return this.services.set(j,{factory:q,lifetime:"singleton"}),this}registerTransient(j,q){return this.services.set(j,{factory:q,lifetime:"transient"}),this}registerScoped(j,q){return this.services.set(j,{factory:q,lifetime:"scoped"}),this}registerInstance(j,q){return this.services.set(j,{factory:()=>q,lifetime:"singleton",instance:q}),this}getService(j){let q=this.services.get(j);if(q)return this.resolveService(j,q);if(this.parent)return this.parent.getService(j);return}getRequiredService(j){let q=this.getService(j);if(q===void 0){let J=typeof j==="string"?j:j.name||"Unknown";throw Error(`Required service not found: ${J}`)}return q}hasService(j){return this.services.has(j)||(this.parent?.hasService(j)??!1)}createScope(){return new Q(this)}dispose(){for(let j of this.scopedInstances.values())if(j&&typeof j.dispose==="function")j.dispose();this.scopedInstances.clear()}resolveService(j,q){switch(q.lifetime){case"singleton":if(!q.instance)q.instance=q.factory();return q.instance;case"scoped":if(!this.scopedInstances.has(j))this.scopedInstances.set(j,q.factory());return this.scopedInstances.get(j);case"transient":default:return q.factory()}}getRegisteredServices(){let j=Array.from(this.services.keys());if(this.parent)j.push(...this.parent.getRegisteredServices());return Array.from(new Set(j))}}var z=null;function V(){if(!z)z=new Q;return z}function g(j){let q=V();j(q)}function k(){if(z)z.dispose();z=null}class H{provider=new Q;singleton(j,q){return this.provider.registerSingleton(j,q),this}transient(j,q){return this.provider.registerTransient(j,q),this}scoped(j,q){return this.provider.registerScoped(j,q),this}instance(j,q){return this.provider.registerInstance(j,q),this}build(){return this.provider}}class I extends Z{serviceProvider=V();render(){let j={getService:(J)=>this.serviceProvider.getService(J),serviceProvider:this.serviceProvider};return this.build(j).render()}}class L extends Z{_state=null;_mounted=!1;_renderScheduled=!1;_renderManager=new G;serviceProvider=V();get state(){if(!this._state)this._state=this.createState(),this._state._setComponent(this),this._state.onInit();return this._state}render(){let j={getService:(J)=>this.serviceProvider.getService(J),serviceProvider:this.serviceProvider};return this.state._context=j,this.state.build(j).render()}mount(j){let q=this.render();this._renderManager.mount(q,j),this._mounted=!0,this.state.onMount()}_scheduleRender(){if(this._renderScheduled)return;this._renderScheduled=!0,requestAnimationFrame(()=>{if(this._renderScheduled=!1,this._mounted){let j=this.render();this._renderManager.update(j),this.state.onUpdate()}})}unmount(){if(this._mounted&&this._state)this._state.onDispose(),this._renderManager.unmount(),this._mounted=!1}}class x{_component=null;_context=null;_needsRender=!1;get component(){if(!this._component)throw Error("State not initialized");return this._component}_setComponent(j){this._component=j}setState(j){j(),this._needsRender=!0,this.component._scheduleRender()}onInit(){}onMount(){}onUpdate(){}onDispose(){}}class M{baseUrl;constructor(j="/api/_equantic/actions"){this.baseUrl=j}async invoke(j,q=[]){let K=await(await fetch(this.baseUrl,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({actionId:j,arguments:q})})).json();if(!K.success)throw Error(K.error||`Server action failed: ${j}`);return K.result}}var W=null;function y(){if(!W)W=new M;return W}function N(j){W=new M(j)}function v(){W=null}class R extends Z{render(){return{tag:"div",attributes:this.buildAttributes(),events:{},children:this.children.map((j)=>j.render())}}}class T extends Z{direction="row";justify;align;gap;wrap=!1;render(){let j=this.buildAttributes(),q=["display: flex",`flex-direction: ${this.direction}`];if(this.justify)q.push(`justify-content: ${this.justify}`);if(this.align)q.push(`align-items: ${this.align}`);if(this.gap)q.push(`gap: ${this.gap}`);if(this.wrap)q.push("flex-wrap: wrap");let J=j.style||"";return j.style=J?`${J}; ${q.join("; ")}`:q.join("; "),{tag:"div",attributes:j,events:{},children:this.children.map((K)=>K.render())}}}class b extends T{constructor(){super();this.direction="column"}}class A extends T{constructor(){super();this.direction="row"}}class P extends Z{content="";paragraph=!1;constructor(j){super();if(j)this.content=j}render(){return{tag:this.paragraph?"p":"span",attributes:this.buildAttributes(),events:{},children:[{tag:"#text",attributes:{},events:{},children:[],textContent:this.content}]}}}class S extends Z{content="";level=1;constructor(j,q=1){super();if(j)this.content=j;this.level=Math.min(6,Math.max(1,q))}render(){return{tag:`h${this.level}`,attributes:this.buildAttributes(),events:{},children:[{tag:"#text",attributes:{},events:{},children:[],textContent:this.content}]}}}class f extends Z{type="button";disabled=!1;text;onClick;render(){let j=this.buildAttributes();if(j.type=this.type,this.disabled)j.disabled="true";let q={};if(this.onClick)q.click=this.onClick;let J=this.children.length>0?this.children.map((K)=>K.render()):this.text?[{tag:"#text",attributes:{},events:{},children:[],textContent:this.text}]:[];return{tag:"button",attributes:j,events:q,children:J}}}class h extends Z{type="text";value="";placeholder;disabled=!1;readOnly=!1;name;onChange;onInput;render(){let j=this.buildAttributes();if(j.type=this.type,j.value=this.value,this.placeholder)j.placeholder=this.placeholder;if(this.disabled)j.disabled="true";if(this.readOnly)j.readonly="true";if(this.name)j.name=this.name;let q={};if(this.onChange)q.change=this.onChange;if(this.onInput)q.input=this.onInput;return{tag:"input",attributes:j,events:q,children:[]}}}class C extends Z{href="#";target;text;render(){let j=this.buildAttributes();if(j.href=this.href,this.target)j.target=this.target;if(this.target==="_blank")j.rel="noopener noreferrer";let q=this.children.length>0?this.children.map((J)=>J.render()):this.text?[{tag:"#text",attributes:{},events:{},children:[],textContent:this.text}]:[];return{tag:"a",attributes:j,events:{},children:q}}}function p(j,q){let J=document.querySelector(q);if(!J)throw Error(`Container not found: ${q}`);j.mount(J)}function Qj(j,q){let J=new j;return p(J,q),J}async function m(){console.log("eQuantic.UI Runtime (v2.1) initializing...");try{let j=window.__EQ_CONFIG||{},q=s(j);if(!q){c();return}await i(q,j.version)}catch(j){d(j)}}function s(j){if(j.page)return j.page;return new URLSearchParams(window.location.search).get("page")}async function i(j,q){let J=document.getElementById("app");if(!J)throw Error("Root element #app not found");J.innerHTML='<div class="loading">Loading resource...</div>';try{let K=q?`?v=${q}`:"",O=`/_equantic/${j}.js${K}`;console.log(`eQuantic.UI: Loading module '${O}'...`);let _=(await import(O))[j];if(!_)throw Error(`Module ${j} does not export class '${j}'`);console.log(`eQuantic.UI: Mounting ${j}...`);let Y=new _;if(typeof Y.mount==="function")J.innerHTML="",Y.mount(J);else if(typeof Y.render==="function")J.innerHTML="",Y.render(J);else console.warn("Component missing mount/render method",Y),J.innerHTML=`
                <div style="padding: 2rem; color: #166534; background: #dcfce7; border-radius: 8px;">
                    <h1 style="margin:0">âœ… Loaded ${j}</h1>
                    <p>Instance created but no <code>mount()</code> method found.</p>
                </div>
            `}catch(K){if(K.message?.includes("Failed to fetch")||K.message?.includes("Cannot find module"))E(J,j);else throw K}}function c(){if(window.location.pathname==="/"||window.location.pathname==="")a(document.getElementById("app"));else E(document.getElementById("app"),window.location.pathname)}function d(j){console.error("Runtime Error:",j);let q=document.getElementById("app");if(q)q.innerHTML=`
            <div style="color: #991b1b; padding: 20px; text-align: center; font-family: system-ui;">
                <h3>Application Error</h3>
                <pre style="background: #fef2f2; padding: 10px; border-radius: 4px; display: inline-block; text-align: left;">${j.message}</pre>
            </div>
        `}function E(j,q){j.innerHTML=`
        <div style='display: flex; flex-direction: column; align-items: center; justify-content: center; height: 100vh; font-family: system-ui, sans-serif; text-align: center;'>
            <h1 style='font-size: 6rem; margin: 0; color: #cbd5e1;'>404</h1>
            <h2 style='font-size: 2rem; margin: 1rem 0; color: #1e293b;'>Page Not Found</h2>
            <p style='color: #64748b; font-size: 1.2rem;'>The resource '<strong>${l(q)}</strong>' does not exist.</p>
            <a href='/' style='margin-top: 2rem; padding: 0.75rem 1.5rem; background: #2563eb; color: white; text-decoration: none; border-radius: 0.5rem; font-weight: 500;'>Go Home</a>
        </div>
    `}function a(j){j.innerHTML=`
        <div style='text-align:center; padding: 2rem; font-family: sans-serif; height: 100vh; display: flex; flex-direction: column; justify-content: center; align-items: center;'>
            <h1 style="color: #2563eb; font-size: 2.5rem;">Welcome to eQuantic.UI</h1>
            <p style="color: #64748b;">No default page configured.</p>
        </div>
    `}function l(j){return j.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;")}m();export{k as resetServiceProvider,v as resetServerActionsClient,w as resetReconciler,p as mount,y as getServerActionsClient,V as getRootServiceProvider,D as getReconciler,Qj as createApp,g as configureServices,N as configureServerActions,m as boot,h as TextInput,P as Text,I as StatelessComponent,L as StatefulComponent,Q as ServiceProvider,U as ServiceLifetime,H as ServiceCollectionBuilder,M as ServerActionsClient,A as Row,G as RenderManager,B as Reconciler,C as Link,S as Heading,T as Flex,R as Container,x as ComponentState,Z as Component,b as Column,f as Button};

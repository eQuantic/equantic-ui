<Project Sdk="Microsoft.NET.Sdk">

    <PropertyGroup>
        <TargetFramework>net8.0</TargetFramework>
        <IncludeBuildOutput>false</IncludeBuildOutput>
        <IsPackable>true</IsPackable>
        <PackageId>eQuantic.UI.Sdk</PackageId>
        <Description>MSBuild SDK for eQuantic UI components.</Description>
        <PackageType>MSBuildSdk</PackageType>
    </PropertyGroup>

    <ItemGroup>
        <Content Include="Sdk\**" PackagePath="Sdk" />
        <Content Include="Sdk\Sdk.props" PackagePath="build\eQuantic.UI.Sdk.props" />
        <Content Include="Sdk\Sdk.targets" PackagePath="build\eQuantic.UI.Sdk.targets" />
        <!-- Embed Standard Components Source for Compiler -->
        <Content Include="..\eQuantic.UI.Components\**\*.cs" PackagePath="tools\StandardComponents" />
    </ItemGroup>

    <!-- Bundle Runtimes based on OS (Meta-Packages) -->
    <!-- Using ProjectReference for local development -->
    <ItemGroup Condition="$([MSBuild]::IsOSPlatform('Windows'))">
        <ProjectReference Include="..\eQuantic.UI.Runtime.Win64\eQuantic.UI.Runtime.Win64.csproj" />
    </ItemGroup>
    <ItemGroup Condition="$([MSBuild]::IsOSPlatform('Linux'))">
        <ProjectReference
            Include="..\eQuantic.UI.Runtime.Linux64\eQuantic.UI.Runtime.Linux64.csproj" />
    </ItemGroup>
    <ItemGroup Condition="$([MSBuild]::IsOSPlatform('OSX'))">
        <ProjectReference Include="..\eQuantic.UI.Runtime.Osx64\eQuantic.UI.Runtime.Osx64.csproj" />
    </ItemGroup>

    <ItemGroup>
        <ProjectReference Include="..\eQuantic.Build\eQuantic.Build.csproj"
            ReferenceOutputAssembly="false" />
    </ItemGroup>

    <PropertyGroup>
        <TargetsForTfmSpecificContentInPackage>
            $(TargetsForTfmSpecificContentInPackage);CollectBuildOutput</TargetsForTfmSpecificContentInPackage>
    </PropertyGroup>

    <Target Name="CollectBuildOutput">
        <MSBuild Projects="..\eQuantic.Build\eQuantic.Build.csproj" Targets="Build"
            Properties="Configuration=$(Configuration)" />
        <ItemGroup>
            <_BuildOutput Include="..\eQuantic.Build\bin\$(Configuration)\net8.0\**"
                Exclude="..\eQuantic.Build\bin\$(Configuration)\net8.0\*.pdb" />
        </ItemGroup>
        <ItemGroup>
            <TfmSpecificPackageFile Include="@(_BuildOutput)" PackagePath="tools\net8.0" />
        </ItemGroup>
    </Target>

</Project>